<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="http://code.jquery.com/jquery-1.4.2.min.js"></script>

    <style>
      body {
        margin-top: 12px;
      }
      div.img {
        border: 1px solid #ccc;
      }

      div.img:hover {
        border: 1px solid #777;
      }

      div.gallery img {
        width: 100%;
        height: auto;
      }

      div.desc {
        padding-top: 10px;
        text-align: center;
        font-size: 0.7em;
        color: #478EC1;
      }
      * {
        box-sizing: border-box;
      }

      .responsive {
        padding: 0px 6px 20px 6px;
        float: left;
        width: 49.99999%;
      }

      .clearfix:after {
        content: "";
        display: table;
        clear: both;
      }
    </style>

    <script type="text/javascript">
      var varUA = navigator.userAgent.toLowerCase(); //userAgent 값 얻기
      $(document).ready(function() {


          var temp = location.href.split("?");
          var cat=temp[1];

          if(cat == undefined){
            listCall();
          } else {
            listCall(cat);
            if (varUA.match('android') != null) {
              //안드로이드 일때 처리
              window.Android.video(0);
              window.Android.indicator(true);

            } else if (varUA.indexOf("iphone")>-1||varUA.indexOf("ipad")>-1||varUA.indexOf("ipod")>-1) {
              //IOS 일때 처리
              window.location.href = 'interface://indicator?active=Y';
            }
          }
        });

        function listCall(cat = 'cat1'){
          if (varUA.match('android') != null) {
              //안드로이드 일때 처리
              window.Android.indicator(true);
          } else if (varUA.indexOf("iphone")>-1||varUA.indexOf("ipad")>-1||varUA.indexOf("ipod")>-1) {
              //IOS 일때 처리
              window.location.href = 'interface://indicator?active=Y';
          }
          $('div').remove();
          $.ajax({
            url: `https://api.vimeo.com/me/videos?direction=desc&per_page=100&query=${cat}`,
            type: 'GET',
            dataType: 'json',
            success: function(json) {
              var videos = json.data;
              console.log(videos);
              var len = videos.length;

              for (var i = 0; i < len; i++) {
                var responsive = document.createElement('div');
                responsive.setAttribute('class','responsive');

                var gallery = document.createElement('div');
                gallery.setAttribute('class','gallery');
                gallery.setAttribute('onclick', `goVideo('${videos[i].uri.replace('/videos/','')}','${cat}')`);

                var thumb = document.createElement('img');
                thumb.setAttribute('src', videos[i].pictures.sizes[3].link);
                thumb.setAttribute('width', '100%');
                thumb.setAttribute('height', '100%');

                var desc = document.createElement('div');
                desc.setAttribute('class','desc');
                desc.setAttribute('id','title'+i);


                gallery.appendChild(thumb);
                gallery.appendChild(desc);
                responsive.appendChild(gallery);
                document.body.appendChild(responsive);

                var strArr = videos[i].name.split('_');
                $('#title'+i).text(strArr[strArr.length-1]);
              }
              if (varUA.match('android') != null) {
                  //안드로이드 일때 처리
                  window.Android.indicator(false);

              } else if (varUA.indexOf("iphone")>-1||varUA.indexOf("ipad")>-1||varUA.indexOf("ipod")>-1) {
                  //IOS 일때 처리
                  window.location.href = 'interface://indicator?active=N';

              }
            },
            error: function() {
              if (varUA.match('android') != null) {
                  //안드로이드 일때 처리
                  window.Android.indicator(false);

              } else if (varUA.indexOf("iphone")>-1||varUA.indexOf("ipad")>-1||varUA.indexOf("ipod")>-1) {
                  //IOS 일때 처리
                  window.location.href = 'interface://indicator?active=N';
              }
            },
            beforeSend: setHeader
          });
        }

        function setHeader(xhr) {
          xhr.setRequestHeader('Authorization', 'bearer d967edff8e8819bff00b75433aa69324');
        }

        function getCategory(name = 'cat1') {
          return name;
        }

        function goVideo(scode,cat) {
            if (varUA.match('android') != null) {
                  //안드로이드 일때 처리
                  var code;
                  if(cat == 'cat1')
                    code = `HL13_001_${scode}_!`;
                  else
                    code = `HL13_002_${scode}_!`;

                  window.Android.vimeo(code);

            } else if (varUA.indexOf("iphone")>-1||varUA.indexOf("ipad")>-1||varUA.indexOf("ipod")>-1) {
                  //IOS 일때 처리
                  var mcode;
                  if(cat == 'cat1')
                    mcode = '001';
                  else
                    mcode = '002';
                  window.location.href = `interface://vimeo?mcode=${mcode}&${scode}`;
            }

            window.location.href = `chunjae_video.html?${scode}`;
        }
    </script>
</head>
<body>
</body>
</html>
